{"version":3,"sources":["bonzi.es2015"],"names":["Bonzi","id","userPublic","name","color","speed","pitch","voice","colorPrev","data","window","BonziData","drag","dragged","eventQueue","eventRun","event","willCancel","run","mute","eventTypeToFunc","s4","rng","Math","seedrandom","seed","random","selContainer","$container","$","append","selElement","selDialog","selDialogCont","selNametag","selCanvas","width","size","x","height","y","$element","$canvas","$dialog","$dialogCont","$nametag","updateName","updateSprite","generate_event","a","b","c","e","coords","maxCoords","move","contextMenu","selector","build","$trigger","items","callback","cancel","socket","emit","list","animation","duration","show","hide","needsUpdate","runSingleEvent","type","anim","ticks","index","timer","cur","which","drag_start","pageX","pageY","arguments","length","max","min","css","sprite","BonziHandler","updateDialog","push","eventMake","html","clearDialog","stopSpeaking","goingToSpeak","voiceSource","stop","gotoAndPlay","eventNext","talk","text","say","goNext","currentAnimation","pass_idle","indexOf","tmp_idle_start","to_idle","add","floor","unshift","splice","eventType","stage","update","allowHtml","replaceAll","replace","linkify","greentext","substring","speak","play","source","event_list_joke","event_list_fact","setTimeout","removeChild","remove","vid","tag","swag","removeClass","addClass","target","createjs","Sprite","spriteSheets","addChild"],"mappings":"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","file":"babel.es2015.js","sourcesContent":["class Bonzi {\n\tconstructor(id, userPublic) {\n\n\t\t// ========================================================================\n\t\t// VARIABLES/CONSTANTS\n\t\t// ========================================================================\n\t\tthis.userPublic = userPublic || {\n\t\t\tname: \"BonziBUDDY\",\n\t\t\tcolor: \"purple\",\n\t\t\tspeed: 175,\n\t\t\tpitch: 50,\n\t\t\tvoice: \"en-us\"\n\t\t};\n\t\tthis.color = this.userPublic.color;\n\t\tthis.colorPrev;\n\t\tthis.data = window.BonziData;\n\n\t\tthis.drag = false;\n\t\tthis.dragged = false;\n\n\t\tthis.eventQueue = [];\n\n\t\tthis.eventRun = true;\n\t\tthis.event = null;\n\n\t\tthis.willCancel = false;\n\n\t\tthis.run = true;\n\n\t\tthis.mute = false;\n\n\t\tthis.eventTypeToFunc = {\n\t\t\t\"anim\": \"updateAnim\",\n\t\t\t\"html\": \"updateText\",\n\t\t\t\"text\": \"updateText\",\n\t\t\t\"idle\": \"updateIdle\",\n\t\t\t\"add_random\": \"updateRandom\"\n\t\t};\n\n\t\t// ========================================================================\n\t\t// ASSIGN ID\n\t\t// http://stackoverflow.com/a/105074\n\t\t// ========================================================================\n\n\t\tif (typeof id == \"undefined\") {\n\t\t\tthis.id = s4() + s4();\n\t\t} else this.id = id;\n\n\t\tthis.rng = new Math.seedrandom((this.seed || this.id) || Math.random());\n\n\t\t// ========================================================================\n\t\t// HTML POPULATION\n\t\t// ========================================================================\n\t\tthis.selContainer = \"#content\";\n\t\tthis.$container\t= $(this.selContainer);\n\t\t\t\t\n\t\tthis.$container.append(`\n\t\t\t<div id='bonzi_${this.id}' class='bonzi'>\n\t\t\t\t<div class='bonzi_name'></div>\n\t\t\t\t\t<div class='bonzi_placeholder'></div>\n\t\t\t\t<div style='display:none' class='bubble'>\n\t\t\t\t\t<p class='bubble-content'></p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`);\n\n\t\tthis.selElement = \"#bonzi_\" + this.id;\n\t\tthis.selDialog = this.selElement + \" > .bubble\";\n\t\tthis.selDialogCont = this.selElement + \" > .bubble > p\";\n\t\tthis.selNametag = this.selElement + \" > .bonzi_name\";\n\n\t\tthis.selCanvas = this.selElement + \" > .bonzi_placeholder\";\n\t\t$(this.selCanvas)\n\t\t\t.width(this.data.size.x)\n\t\t\t.height(this.data.size.y);\n\n\t\tthis.$element\t= $(this.selElement);\n\t\tthis.$canvas\t= $(this.selCanvas);\n\t\tthis.$dialog\t= $(this.selDialog);\n\t\tthis.$dialogCont\t= $(this.selDialogCont);\n\t\tthis.$nametag\t= $(this.selNametag);\n\n\t\tthis.updateName();\n\n\t\t$.data(this.$element[0], \"parent\", this);\n\n\t \tthis.updateSprite(true);\n\n\t\t// ========================================================================\n\t\t// EVENTS\n\t\t// ========================================================================\n\t\tthis.generate_event = function(a, b, c) { // Selector, event, function\n\t\t\ta[b](e => { this[c](e); });\n\t\t};\n\n\t\tthis.generate_event(\n\t \t\tthis.$canvas,\n\t\t\t\"mousedown\",\n\t\t\t\"mousedown\"\n\t\t);\n\t\t\n\t\tthis.generate_event(\n\t\t\t$(window),\n\t\t\t\"mousemove\",\n\t\t\t\"mousemove\"\n\t\t);\n\t\t\n\t\tthis.generate_event(\n\t\t\t$(window),\n\t\t\t\"mouseup\",\n\t\t\t\"mouseup\"\n\t\t);\n\n\t\tvar coords = this.maxCoords();\n\t\tthis.x = coords.x * this.rng();\n\t\tthis.y = coords.y * this.rng();\n\t\tthis.move();\n\n\t\t// ========================================================================\n\t\t// MENU\n\t\t// ========================================================================\n\n\t\t$.contextMenu({\n\t\t\tselector: this.selCanvas,\n\t\t\tbuild: ($trigger, e) => {\n\t\t\t\treturn { items: {\n\t\t\t\t\t\"cancel\": {\n\t\t\t\t\t\tname: \"Cancel\",\n\t\t\t\t\t\tcallback: () => { this.cancel(); }\n\t\t\t\t\t},\n\t\t\t\t\t\"mute\": {\n\t\t\t\t\t\tname: () => this.mute ? \"Unmute\" : \"Mute\",\n\t\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\t\tthis.cancel();\n\t\t\t\t\t\t\tthis.mute = !this.mute;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t\"asshole\": {\n\t\t\t\t\t\tname: \"Call an Asshole\",\n\t\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\t\tsocket.emit(\"command\", {\n\t\t\t\t\t\t\t\tlist: [\"asshole\", this.userPublic.name]\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t\"owo\": {\n\t\t\t\t\t\tname: \"Notice Bulge\",\n\t\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\t\tsocket.emit(\"command\", {\n\t\t\t\t\t\t\t\tlist: [\"owo\", this.userPublic.name]\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} };\n\t\t\t},\n\t\t\tanimation: {\n\t\t\t\tduration: 175,\n\t\t\t\tshow: 'fadeIn',\n\t\t\t\thide: 'fadeOut'\n\t\t\t}\n\t\t});\n\n\t\t// ========================================================================\n\t\t// UPDATE LOOP\n\t\t// ========================================================================\n\n\t\tthis.needsUpdate = false;\n\n\t\tthis.runSingleEvent([{\n\t\t\ttype: \"anim\",\n\t\t\tanim: \"surf_intro\",\n\t\t\tticks: 30\n\t\t}]);\n\t}\n\n\teventMake(list) {\n\t\treturn {\n\t\t\tlist: list,\n\t\t\tindex: 0,\n\t\t\ttimer: 0,\n\t\t\tcur: function() { return this.list[this.index] }\n\t\t};\n\t}\n\n\tmousedown(e) {\n\t\tif (e.which == 1) {\n\t\t\tthis.drag = true;\n\t\t\tthis.dragged = false;\n\t\t\tthis.drag_start = {\n\t\t\t\tx: e.pageX - this.x,\n\t\t\t\ty: e.pageY - this.y\n\t\t\t};\n\t\t}\n\t}\n\n\tmousemove(e) {\n\t\tif (this.drag) {\n\t\t\tthis.move(\n\t\t\t\te.pageX - this.drag_start.x,\n\t\t\t\te.pageY - this.drag_start.y\n\t\t\t);\n\t\t\tthis.dragged = true;\n\t\t}\n\t}\n\n\tmove(x, y) {\n\t\tif (arguments.length !== 0) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t}\n\t\tvar max = this.maxCoords();\n\t\tthis.x = Math.min(\n\t\t\tMath.max(0, this.x),\n\t\t\tmax.x\n\t\t);\n\t\tthis.y = Math.min(\n\t\t\tMath.max(0, this.y),\n\t\t\tmax.y\n\t\t);\n\t\tthis.$element.css({\n\t\t\t\"marginLeft\": this.x,\n\t\t\t\"marginTop\": this.y\n\t\t});\n\n\t\tthis.sprite.x = this.x;\n\t\tthis.sprite.y = this.y;\n\t\tBonziHandler.needsUpdate = true;\n\t\tthis.updateDialog();\n\t}\n\n\tmouseup(e) {\n\t\tif (!this.dragged && this.drag)\n\t\t\tthis.cancel();\n\n\t\tthis.drag = false;\n\t\tthis.dragged = false;\n\t}\n\n\trunSingleEvent(list) {\n\t\tif (!this.mute)\n\t\t\tthis.eventQueue.push(this.eventMake(list));\n\t}\n\n\tclearDialog() {\n\t\tthis.$dialogCont.html(\"\");\n\t\tthis.$dialog.hide();\n\t}\n\n\tcancel() {\n\t\tthis.clearDialog();\n\t\tthis.stopSpeaking();\n\t\tthis.eventQueue = [this.eventMake([{ type: \"idle\" }])];\n\t}\n\n\tretry() {\n\t\tthis.clearDialog();\n\t\tthis.event.timer = 0;\n\t}\n\n\tstopSpeaking() {\n\t\tthis.goingToSpeak = false;\n\t\ttry {\n\t\t\tthis.voiceSource.stop();\n\t\t} catch(e) {}\n\t}\n\n\tcancelQueue() {\n\t\tthis.willCancel = true;\n\t}\n\n\n\tupdateAnim() {\n\t\tif (this.event.timer === 0)\n\t\t\tthis.sprite.gotoAndPlay(this.event.cur().anim);\n\t\tthis.event.timer++;\n\t\tBonziHandler.needsUpdate = true;\n\t\tif (this.event.timer >= this.event.cur().ticks)\n\t\t\tthis.eventNext();\n\t}\n\n\tupdateText() {\n\t\tif (this.event.timer === 0) {\n\t\t\tthis.$dialog.css(\"display\", \"block\");\n\t\t\tthis.event.timer = 1;\n\t\t\tthis.talk(\n\t\t\t\tthis.event.cur().text,\n\t\t\t\tthis.event.cur().say,\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t\t\n\t\tif (this.$dialog.css(\"display\") == \"none\")\n\t\t\tthis.eventNext();\n\t}\n\n\tupdateIdle() {\n\t\tvar goNext =\n\t\t\t(this.sprite.currentAnimation == \"idle\") &&\n\t\t\t(this.event.timer === 0);\n\n\t\tgoNext = goNext ||\n\t\t\tthis.data.pass_idle.indexOf(\n\t\t\t\tthis.sprite.currentAnimation\n\t\t\t) != -1;\n\n\t\tif (goNext)\n\t\t\tthis.eventNext();\n\t\telse {\n\t\t\tif (this.event.timer === 0) {\n\t\t\t\tthis.tmp_idle_start =\n\t\t\t\t\tthis.data.to_idle[this.sprite.currentAnimation];\n\t\t\t\tthis.sprite.gotoAndPlay(this.tmp_idle_start);\n\t\t\t\tthis.event.timer = 1;\n\t\t\t}\n\t\t\t\n\t\t\tif (this.tmp_idle_start != this.sprite.currentAnimation)\n\t\t\t\tif (this.sprite.currentAnimation == \"idle\")\n\t\t\t\t\tthis.eventNext();\n\n\t\t\tBonziHandler.needsUpdate = true;\n\t\t}\n\t}\n\n\tupdateRandom() {\n\t\tvar add = this.event.cur().add;\n\t\tvar index = Math.floor(add.length * this.rng());\n\n\t\tvar e = this.eventMake(add[index]);\n\t\tthis.eventNext();\n\t\tthis.eventQueue.unshift(e);\n\t}\n\n\tupdate() {\n\t\tif (!this.run) return; \n\t\t// ========================================================================\n\t\t// EVENTS\n\t\t// \"the fun part\"\n\t\t// ========================================================================\n\n\t\tif ((this.eventQueue.length !== 0) && (this.eventQueue[0].index >= this.eventQueue[0].list.length))\n\t\t\tthis.eventQueue.splice(0,1);\n\n\t\tthis.event = this.eventQueue[0];\n\n\t\tif ((this.eventQueue.length !== 0) && this.eventRun) {\n\t\t\tvar eventType = this.event.cur().type;\n\t\t\ttry {\n\t\t\t\tthis[this.eventTypeToFunc[eventType]]();\n\t\t\t} catch(e) { this.event.index++; }\n\t\t}\n\n\t\tif (this.willCancel) {\n\t\t\tthis.cancel();\n\t\t\tthis.willCancel = false;\n\t\t}\n\n\t\tif (this.needsUpdate) {\n\t\t\tthis.stage.update();\n\t\t\tthis.needsUpdate = false;\n\t\t}\n\t}\n\n\teventNext() {\n\t\tthis.event.timer = 0;\n\t\tthis.event.index += 1;\n\t}\n\n\ttalk(text, say, allowHtml) {\n\t\tallowHtml = allowHtml || false;\n\t\ttext = replaceAll(text, \"{NAME}\", this.userPublic.name);\n\t\ttext = replaceAll(text, \"{COLOR}\", this.color);\n\t\tif (typeof say !== \"undefined\") {\n\t\t\tsay = replaceAll(say, \"{NAME}\", this.userPublic.name);\n\t\t\tsay = replaceAll(say, \"{COLOR}\", this.color);\n\t\t} else {\n\t\t\tsay = text.replace(\"&gt;\", \"\");\n\t\t}\n\n\t\ttext = linkify(text);\n\t\tvar greentext = \n\t\t\t(text.substring(0, 4) == \"&gt;\") ||\n\t\t\t(text[0] == \">\");\n\n\t\tthis.$dialogCont\n\t\t\t[allowHtml ? \"html\" : \"text\"](text)\n\t\t\t[greentext ? \"addClass\" : \"removeClass\"](\"bubble_greentext\")\n\t\t\t.css(\"display\", \"block\");\n\n\t\tthis.stopSpeaking();\n\n\t\tthis.goingToSpeak = true;\n\n\t\tspeak.play(say, {\n\t\t\t\"pitch\": this.userPublic.pitch,\n\t\t\t\"speed\": this.userPublic.speed\n\t\t}, () => { // onended\n\t\t\tthis.clearDialog()\n\t\t}, (source) => {\n\t\t\tif (!this.goingToSpeak) source.stop();\n\t\t\tthis.voiceSource = source;\n\t\t});\n\t}\n\n\tjoke() { this.runSingleEvent(this.data.event_list_joke); }\n\n\tfact() { this.runSingleEvent(this.data.event_list_fact); }\n\n\texit(callback) {\n\t\tthis.runSingleEvent([{\n\t\t\ttype: \"anim\",\n\t\t\tanim: \"surf_away\",\n\t\t\tticks: 30\n\t\t}]);\n\t\tsetTimeout(callback, 2000);\n\t}\n\n\tdeconstruct() {\n\t\tthis.stopSpeaking();\n\t\tBonziHandler.stage.removeChild(this.sprite);\n\t\tthis.run = false;\n\t\tthis.$element.remove();\n\t}\n\n\tupdateName() { this.$nametag.text(this.userPublic.name); }\n\n\tyoutube(vid) {\n\t\tif (!this.mute) {\n\t\t\tvar tag = \"iframe\";\n\t\t\tthis.$dialogCont\n\t\t\t\t.html(`\n\t\t\t\t\t<${tag} type=\"text/html\" width=\"173\" height=\"173\" \n\t\t\t\t\tsrc=\"https://www.youtube.com/embed/${vid}?autoplay=1\" \n\t\t\t\t\tstyle=\"width:173px;height:173px\"\n\t\t\t\t\tframeborder=\"0\"\n\t\t\t\t\tallowfullscreen=\"allowfullscreen\"\n\t\t\t\t\tmozallowfullscreen=\"mozallowfullscreen\"\n\t\t\t\t\tmsallowfullscreen=\"msallowfullscreen\"\n\t\t\t\t\toallowfullscreen=\"oallowfullscreen\"\n\t\t\t\t\twebkitallowfullscreen=\"webkitallowfullscreen\"\n\t\t\t\t\t></${tag}>\n\t\t\t\t`)\n\t\t\tthis.$dialog.show();\n\t\t}\n\t}\n\n\tbackflip(swag) {\n\t\tvar event = [{\n\t\t\ttype: \"anim\",\n\t\t\tanim: \"backflip\",\n\t\t\tticks: 15\n\t\t}];\n\t\tif (swag) {\n\t\t\tevent.push({\n\t\t\t\ttype: \"anim\",\n\t\t\t\tanim: \"cool_fwd\",\n\t\t\t\tticks: 30\n\t\t\t});\n\t\t\tevent.push({\n\t\t\t\ttype: \"idle\"\n\t\t\t});\n\t\t}\n\t\tthis.runSingleEvent(event);\n\t}\n\n\tupdateDialog() {\n\t\t// ========================================================================\n\t\t// DIALOG BOX\n\t\t// ========================================================================\n\t\tvar max = this.maxCoords();\n\t\tif (this.data.size.x + this.$dialog.width() > max.x) {\n\t\t\tif (this.y < (this.$container.height() / 2) - (this.data.size.x / 2)) {\n\t\t\t\tthis.$dialog\n\t\t\t\t\t.removeClass(\"bubble-top\")\n\t\t\t\t\t.removeClass(\"bubble-left\")\n\t\t\t\t\t.removeClass(\"bubble-right\")\n\t\t\t\t\t.addClass(\"bubble-bottom\");\n\t\t\t} else {\n\t\t\t\tthis.$dialog\n\t\t\t\t\t.removeClass(\"bubble-bottom\")\n\t\t\t\t\t.removeClass(\"bubble-left\")\n\t\t\t\t\t.removeClass(\"bubble-right\")\n\t\t\t\t\t.addClass(\"bubble-top\");\n\t\t\t}\n\t\t} else {\t\t\n\t\t\tif (this.x < (this.$container.width() / 2) - (this.data.size.x / 2)) {\n\t\t\t\tthis.$dialog\n\t\t\t\t\t.removeClass(\"bubble-left\")\n\t\t\t\t\t.removeClass(\"bubble-top\")\n\t\t\t\t\t.removeClass(\"bubble-bottom\")\n\t\t\t\t\t.addClass(\"bubble-right\");\n\t\t\t} else {\n\t\t\t\tthis.$dialog\n\t\t\t\t\t.removeClass(\"bubble-right\")\n\t\t\t\t\t.removeClass(\"bubble-top\")\n\t\t\t\t\t.removeClass(\"bubble-bottom\")\n\t\t\t\t\t.addClass(\"bubble-left\");\n\t\t\t}\n\t\t}\n\t}\n\n\tmaxCoords() {\n\t\treturn {\n\t\t\tx: this.$container.width() - this.data.size.x,\n\t\t\ty: this.$container.height() - this.data.size.y - $(\"#chat_bar\").height()\n\t\t};\n\t}\n\n\tasshole(target) {\n\t\tthis.runSingleEvent(\n\t\t\t[{\n\t\t\t\ttype: \"text\",\n\t\t\t\ttext: \"Hey, \" + target + \"!\"\n\t\t\t}, {\n\t\t\t\ttype: \"text\",\n\t\t\t\ttext: \"You're a fucking asshole!\",\n\t\t\t\tsay: \"your a fucking asshole!\"\n\t\t\t}, {\n\t\t\t\ttype: \"anim\",\n\t\t\t\tanim: \"grin_fwd\",\n\t\t\t\tticks: 15\n\t\t\t}, {\n\t\t\t\ttype: \"idle\"\n\t\t\t}]\n\t\t);\n\t}\n\t\n\towo(target) {\n\t\tthis.runSingleEvent(\n\t\t\t[{\n\t\t\t\ttype: \"text\",\n\t\t\t\ttext: `*notices ${target}'s BonziBulge™*`,\n\t\t\t\tsay: `notices ${target}s bonzibulge`\n\t\t\t}, {\n\t\t\t\ttype: \"text\",\n\t\t\t\ttext: \"owo, wat dis?\",\n\t\t\t\tsay: \"oh woah, what diss?\"\n\t\t\t}]\n\t\t);\n\t}\n\n\tupdateSprite(hide) {\n\t\tvar stage = BonziHandler.stage;\n\t\tthis.cancel();\n\t\tstage.removeChild(this.sprite);\n\t\tif (this.colorPrev != this.color) {\n\t\t\tdelete this.sprite;\n\t\t\tthis.sprite = new createjs.Sprite(\n\t\t\t\tBonziHandler.spriteSheets[this.color],\n\t\t\t\thide ? \"gone\" : \"idle\"\n\t\t\t);\n\t\t}\n\t\tstage.addChild(this.sprite);\n\t\tthis.move();\n\t}\n}"]}